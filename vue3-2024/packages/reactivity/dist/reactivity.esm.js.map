{
  "version": 3,
  "sources": ["../src/effect.ts", "../../shared/src/index.ts", "../src/baseHandlers.ts", "../src/reactive.ts"],
  "sourcesContent": ["export let  activeEffect;// \u5F53\u524D\u7684effect\n\nclass ReactiveEffect{\n    // \u4F9D\u8D56\u9879\n    public deps=[]\n    // \u662F\u5426\u6FC0\u6D3B\n   public  active=true\n   public parent = undefined;\n    constructor(public fn){\n\n    }\n    run(){\n        if(!this.active){\n            // \u672A\u6FC0\u6D3B,\u76F4\u63A5\u6267\u884C\n           return  this.fn()\n        }\n\n        try{\n            this.parent = activeEffect\n            activeEffect = this\n          return   this.fn()\n        }\n        finally{\n            activeEffect = this.parent \n            this.parent = undefined\n        }\n\n      \n\n      \n\n\n\n\n\n\n\n    }\n}\n\n// \u4F9D\u8D56\u6536\u96C6\u5C31\u662F\u628A\u5F53\u524D\u7684effect\u53D8\u6210\u5168\u5C40\u7684,\u7A0D\u540E\u53D6\u503C\u7684\u65F6\u5019,\u53EF\u4EE5\u62FF\u5230\u8FD9\u4E2A\u5168\u5C40\u7684effect\nexport function effect(fn){\n\n  const _effect =   new ReactiveEffect(fn);\n  // \u9ED8\u8BA4\u8BA9\u54CD\u5E94\u5F0F\u7684effect\u6267\u884C\u4E00\u6B21\n  _effect.run()\n    \n}\n\nconst targetMap = new WeakMap()\n\nexport function track(target,key){\n    if(!activeEffect){ //\u53D6\u503C\u64CD\u4F5C\u6CA1\u6709\u5728effect\u4E2D\n        return \n    }\n    let  depsMap = targetMap.get(target)\n    if(!depsMap){\n        targetMap.set(target,(depsMap = new Map()))\n    }\n    let  dep = depsMap.get(key)\n    if(!dep){\n         depsMap.set(key,(dep = new Set()))\n    }\n\n    let shouldTrack = !dep.has(activeEffect); \n\n    if(shouldTrack){\n        dep.add(activeEffect)\n\n        activeEffect.deps.push(dep);\n        console.log( activeEffect.deps,\" activeEffect.deps\")\n\n        // \u4E00\u4E2A\u5C5E\u6027\u5BF9\u5E94\u591A\u4E2Aeffect,\u4E00\u4E2Aeffect\u5BF9\u5E94\u591A\u4E2A\u5C5E\u6027\n    }\n   \n    \n   \n     \n}", "export function isObject(value) {\r\n  return value !== null && typeof value === \"object\";\r\n}\r\n", "import { activeEffect, track } from \"./effect\"\nimport { ReactiveFlags } from \"./reactive\"\n\nexport const mutableHandlers = {\n    get(target,p,receiver){\n        console.log(p,'p111 ')\n        // \u8BBF\u95EE\u7684\u65F6\u5019\u89E6\u53D1\n        if(ReactiveFlags.IS_REACTIVE===p){\n            return true\n        }\n\n\n        track(target,p)\n       \n      \n\n        // \u5904\u7406\u4E86this\u95EE\u9898\n        return Reflect.get(target,p,receiver)\n    },\n    set(target ,p, newValue, receiver){\n\n       \n\n        return  Reflect.set(target ,p, newValue, receiver)\n    }\n}", "import { isObject } from \"@core/shared\";\nimport { mutableHandlers } from \"./baseHandlers\";\n\nexport const enum ReactiveFlags {\n    IS_REACTIVE=\"__v_isReactive\"\n}\n\n\n\nconst reactiveMap = new WeakMap();\n\nexport function reactive(target){\n    if(!isObject(target)){\n        return target\n    }\n    // \u653E\u8FDB\u6765\u4E00\u4E2A\u88AB\u4EE3\u7406\u8FC7\u7684proxy\u5B9E\u4F8B\u7684\u60C5\u51B5\n    if(target[ReactiveFlags.IS_REACTIVE]){\n        return target\n    }\n    // \u7F13\u5B58\u4E00\u4E0B\u4EE3\u7406\u8FC7\u7684\u5BF9\u8C61,\u4E0B\u4E00\u6B21\u518D\u8FDB\u884C\u4EE3\u7406\u7684\u65F6\u5019,\u76F4\u63A5\u62FF\u51FA\u6765\u7528\u5C31\u53EF\u4EE5\n    if(reactiveMap.has(target)){\n        return reactiveMap.get(target)\n    }\n\n    const proxy = new Proxy(target,mutableHandlers)\n\n    reactiveMap.set(target,proxy)\n\n    return proxy\n\n}"],
  "mappings": ";AAAO,IAAK;AAEZ,IAAM,iBAAN,MAAoB;AAAA,EAMhB,YAAmB,IAAG;AAAH;AAJnB;AAAA,SAAO,OAAK,CAAC;AAEd;AAAA,SAAQ,SAAO;AACf,SAAO,SAAS;AAAA,EAGf;AAAA,EACA,MAAK;AACD,QAAG,CAAC,KAAK,QAAO;AAEb,aAAQ,KAAK,GAAG;AAAA,IACnB;AAEA,QAAG;AACC,WAAK,SAAS;AACd,qBAAe;AACjB,aAAS,KAAK,GAAG;AAAA,IACnB,UACA;AACI,qBAAe,KAAK;AACpB,WAAK,SAAS;AAAA,IAClB;AAAA,EAYJ;AACJ;AAGO,SAAS,OAAO,IAAG;AAExB,QAAM,UAAY,IAAI,eAAe,EAAE;AAEvC,UAAQ,IAAI;AAEd;AAEA,IAAM,YAAY,oBAAI,QAAQ;AAEvB,SAAS,MAAM,QAAO,KAAI;AAC7B,MAAG,CAAC,cAAa;AACb;AAAA,EACJ;AACA,MAAK,UAAU,UAAU,IAAI,MAAM;AACnC,MAAG,CAAC,SAAQ;AACR,cAAU,IAAI,QAAQ,UAAU,oBAAI,IAAI,CAAE;AAAA,EAC9C;AACA,MAAK,MAAM,QAAQ,IAAI,GAAG;AAC1B,MAAG,CAAC,KAAI;AACH,YAAQ,IAAI,KAAK,MAAM,oBAAI,IAAI,CAAE;AAAA,EACtC;AAEA,MAAI,cAAc,CAAC,IAAI,IAAI,YAAY;AAEvC,MAAG,aAAY;AACX,QAAI,IAAI,YAAY;AAEpB,iBAAa,KAAK,KAAK,GAAG;AAC1B,YAAQ,IAAK,aAAa,MAAK,oBAAoB;AAAA,EAGvD;AAKJ;;;AC9EO,SAAS,SAAS,OAAO;AAC9B,SAAO,UAAU,QAAQ,OAAO,UAAU;AAC5C;;;ACCO,IAAM,kBAAkB;AAAA,EAC3B,IAAI,QAAO,GAAE,UAAS;AAClB,YAAQ,IAAI,GAAE,OAAO;AAErB,+CAA+B,GAAE;AAC7B,aAAO;AAAA,IACX;AAGA,UAAM,QAAO,CAAC;AAKd,WAAO,QAAQ,IAAI,QAAO,GAAE,QAAQ;AAAA,EACxC;AAAA,EACA,IAAI,QAAQ,GAAG,UAAU,UAAS;AAI9B,WAAQ,QAAQ,IAAI,QAAQ,GAAG,UAAU,QAAQ;AAAA,EACrD;AACJ;;;ACtBO,IAAW,gBAAX,kBAAWA,mBAAX;AACH,EAAAA,eAAA,iBAAY;AADE,SAAAA;AAAA,GAAA;AAMlB,IAAM,cAAc,oBAAI,QAAQ;AAEzB,SAAS,SAAS,QAAO;AAC5B,MAAG,CAAC,SAAS,MAAM,GAAE;AACjB,WAAO;AAAA,EACX;AAEA,MAAG,OAAO,kCAAyB,GAAE;AACjC,WAAO;AAAA,EACX;AAEA,MAAG,YAAY,IAAI,MAAM,GAAE;AACvB,WAAO,YAAY,IAAI,MAAM;AAAA,EACjC;AAEA,QAAM,QAAQ,IAAI,MAAM,QAAO,eAAe;AAE9C,cAAY,IAAI,QAAO,KAAK;AAE5B,SAAO;AAEX;",
  "names": ["ReactiveFlags"]
}
