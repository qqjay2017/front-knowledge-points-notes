<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="div1">
      <button id="button1">button</button>
    </div>

    <script>
        /**
         * 基础版
         * 
         * */
         function bindEventBase(elem,type,selector,fn){
            if(fn === null){
                fn = selector
                selector=null
            }
            elem.addEventListener(type,e=>{
                let target;
                if(selector){
                    // 需要代理
                    target = e.target;
                    if(target.matches(selector)){
                        fn.call(target,e)
                    }
                }else{
                    // 不需要代理
                    fn(e)
                }

            })
        }
         /**
         * 加强版
         * 允许 type 接受一个数组，从而支持一次绑定多个事件类型。
         * */
      function bindEvent(elem, type, selector, fn) {
        if (!(elem instanceof HTMLElement)) {
          throw new Error("elem must be a valid DOM element");
        }
        if (fn === null) {
          fn = selector;
          selector = null;
        }
        const handler = (e) => {
          let target;
          if (selector) {
            target = e.target.closest(selector);
            if (target) {
              fn.call(target, e);
            }
          } else {
            fn(e);
          }
        };
        elem.addEventListener(type, handler);
        return {
            unbind:()=>{
                elem.removeEventListener(type,handler)
            }
        }
      }
    </script>
  </body>
</html>
